<script>
  // --- Load profile data from localStorage
  function loadProfile() {
    let myBooks = JSON.parse(localStorage.getItem("myBooks")) || ["The Great Gatsby", "1984", "To Kill a Mockingbird"];
    let lentBooks = JSON.parse(localStorage.getItem("lentBooks")) || [
      { book: "The Alchemist", borrower: "Sarah" },
      { book: "Atomic Habits", borrower: "Mike" }
    ];

    const myBooksList = document.getElementById("myBooks");
    const lentBooksList = document.getElementById("lentBooks");

    myBooksList.innerHTML = "";
    lentBooksList.innerHTML = "";

    myBooks.forEach(book => {
      const li = document.createElement("li");
      li.innerHTML = `${book} <button class="remove-btn" onclick="removeBook(this)">‚ùå</button>`;
      myBooksList.appendChild(li);
    });

    lentBooks.forEach((entry, index) => {
      const li = document.createElement("li");
      li.innerHTML = `${entry.book} ‚Üí <em>${entry.borrower}</em> 
        <button class="request-btn" onclick="requestReturn(${index})">üîî Request Return</button>`;
      lentBooksList.appendChild(li);
    });
  }

  function removeBook(button) {
    const li = button.parentElement;
    let myBooks = JSON.parse(localStorage.getItem("myBooks")) || [];
    myBooks = myBooks.filter(book => !li.innerText.includes(book));
    localStorage.setItem("myBooks", JSON.stringify(myBooks));
    li.remove();
  }

  // --- Send return request
  function requestReturn(index) {
    let lentBooks = JSON.parse(localStorage.getItem("lentBooks")) || [];
    let requests = JSON.parse(localStorage.getItem("returnRequests")) || [];

    const entry = lentBooks[index];
    requests.push(entry); // store {book, borrower}
    localStorage.setItem("returnRequests", JSON.stringify(requests));

    alert(`üì¨ Return request sent for: ${entry.book} (borrower: ${entry.borrower})`);
  }

  window.onload = loadProfile;
</script>
